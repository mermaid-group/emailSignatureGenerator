<html>
    <head>
    </head>
<body>
    <h1 style="font-family:Calibri,sans-serif; font-size:24pt;">Mermaid Group - Email Signature Generator</h1>
    <br />
    
    <form>
      Full name:<br>
      <input type="text" id="fullname" name="fullname" style="width: 360"><br>
      <br />

      Job Title:<br>
      <input type="text" id="jobTitle" name="jobTitle" style="width: 360"><br>
      <br />

      Department:<br>
      <input type="text" id="department" name="department" style="width: 360"><br>
      <br />

      Mobile Number(s) [Optional]:<br>
      <input type="text" id="mobileNumbers" name="mobileNumbers" style="width: 360"><br>
      <br />

      Telephone Numbers:<br>
      <input type="text" id="phoneNumbers" name="phoneNumbers" style="width: 360"><br>
      <br />
      
      Email Address:<br>
      <input type="text" id="emailAddress" name="emailAddress" style="width: 360"><br>
      <br />
      

    </form>
 
 
 
    <button onClick="javascript:generateSignature();" style="width: 340px; height: 35px">Generate E-Signature</button>
	<!-- <button onClick="javascript:copyToClipboard('output_iframe');" style="width: 263px; height: 35px">Copy to Clipboard</button> -->
	
    <br />
	<br />
    
    <iframe id="output_iframe" src="about:blank" width=810 height=200></iframe>
 
	<br />
 
    </body>
 
<script language="javascript">
function generateSignature(){
   
    var fullname = document.getElementById("fullname").value
	fullname = "<span><strong>" + fullname + "</strong></span>"
	
	var jobTitle = document.getElementById("jobTitle").value
	var department = document.getElementById("department").value
	
	var mobileNumbers = document.getElementById("mobileNumbers").value
	if(mobileNumbers!=""){
		mobileNumbers = "<span><strong>M </strong>" + mobileNumbers + "</span> | "
	}
	
	var phoneNumbers = document.getElementById("phoneNumbers").value
	
	if(phoneNumbers!=""){
		phoneNumbers = "<span><strong>T </strong>" + phoneNumbers + "</span> | "
	}
	
	var emailAddress = document.getElementById("emailAddress").value
	if(emailAddress!=""){
		emailAddress = "<strong>E </strong>" + '<span> <a href="mailto:' + emailAddress +  '" style="color:blue; text-decoration:underline;">' + emailAddress + "</a></span>"
	}
	
	var string_line_1 = fullname + " | " + jobTitle + " | " + department
	var string_line_2 = mobileNumbers + phoneNumbers + emailAddress
 
    //step 1: get the DOM object of the iframe.
    var iframe = document.getElementById('output_iframe');
 
    var html_string = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><title>ESignature</title><style type="text/css">table.MsoNormalTable.nowrapping {white-space: nowrap;}</style></head><body><table border="0" cellspacing="1" style="width: 820px; height: 80px; font-size:10pt; font-family:Calibri,sans-serif;"><tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes; mso-yfti-lastrow: yes"><td style="width: 79px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"><img style="border-width: 0px; font-size:10pt; font-family:Calibri,sans-serif;" height="55" src="img/logo.png" width="77" class="logo" alt="mermaid-group.com" /></a></td><td style="width: 10px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"></td><td style="width: 720px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"><p class="MsoNormal" style="margin:0px"> <span>' + string_line_1 + '</span> <br /> <span>' + string_line_2 + '</span> <br /> <span>Mermaid Subsea Services</span> | <span><a href="https://www.mermaid-group.com">mermaid-group.com</a></span> </p></td><td style="width: 10px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"></td></tr></table><p style="margin-top:8px"><span style="font-family:Calibri,sans-serif; color: #808080; font-size:6pt "><strong>Disclaimers: </strong>This electronic transmission, and any attachments hereto, is intended only for the use of each individual recipient named above and may contain information belonging to the sender that is confidential, proprietary, is subject to copyright, constitutes a trade secret or is legally privileged. If you are not an intended recipient, you are hereby notified that any disclosure, copying, distribution or the taking of any action in reliance on the contents of this information is strictly prohibited. If you have received this transmission in error, please immediately (i) notify the sender, and (ii) permanently delete and/or destroy the original and all copies of this electronic transmission and all attachments hereto.</p></body></html>';
 
    /* if jQuery is available, you may use the get(0) function to obtain the DOM object like this:
    var iframe = $('iframe#target_iframe_id').get(0);
    */
 
    //step 2: obtain the document associated with the iframe tag
    //most of the browser supports .document. Some supports (such as the NetScape series) .contentDocumet, while some (e.g. IE5/6) supports .contentWindow.document
    //we try to read whatever that exists.
    var iframedoc = iframe.document;
        if (iframe.contentDocument)
            iframedoc = iframe.contentDocument;
        else if (iframe.contentWindow)
            iframedoc = iframe.contentWindow.document;

    
     if (iframedoc){
         // Put the content in the iframe
         iframedoc.open();
         iframedoc.writeln(html_string);
         iframedoc.close();
		
     } else {
        //just in case of browsers that don't support the above 3 properties.
        //fortunately we don't come across such case so far.
        alert('Operation not supported by browser');
     }

	 //copyToClipboard('output_iframe');
	 copyToClip(html_string);
}


function copyToClipboard(elementId) {

	var iframe = document.getElementById(elementId);
	var iframe_contents = iframe.contentDocument.body.innerHTML;
	copyToClip(iframe_contents);
	// alert(iframe_contents);

}

function copyToClip(str) {
  
  function listener(e) {
    e.clipboardData.setData("text/html", str);
    e.clipboardData.setData("text/plain", str);
    e.preventDefault();
  }
  document.addEventListener("copy", listener);
  document.execCommand("copy");
  document.removeEventListener("copy", listener);
   
   
};
 
</script>
</html>