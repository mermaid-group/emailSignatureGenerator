<html>

    <head>
	
		<title>ESignature Generator</title>
		
		<style>
				.radio{
					font-family:Calibri,sans-serif;
				}
			
			.label {
				font-family:Calibri,sans-serif;
			}
			.header{font-size:14pt; font-weight: bold}
			.intro{font-size:14pt; }
			.description{font-size:11pt; color: #797D7F;}

			
		</style>
		
    </head>
	
<body>
    <h1 style="font-family:Calibri,sans-serif; font-size:21pt;">Mermaid Group - Email Signature Generator</h1>
    <br />
    <hr>
	<br>
	<span class="label header">Introduction</span><br>
	<span class="label intro">This web page has been provided for Mermaid staff to create standardized email footer. <br> Please refer to the How-To <a href="https://www.youtube.com/watch?v=1FXIyXtSgn0">video</a> or How-To <a href="/emailSignatureGenerator/src/HowToDoc.pdf"> document</a> , and proceed to generate and apply your personalized email footer</span><br><br>
	<hr>
	<!--
	<iframe width="800" height="450" src="https://www.youtube.com/embed/1FXIyXtSgn0" frameborder="0" allow="accelerometer; autoplay=0 encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> 
	-->
	
	
	<br>
	<br>
	
    <form>
	
		<span class="label header">Are you on ZMOS contract?</span><br>
			
			<form>
				<label class="radio">
					<input type="radio" name="Boolean_OnZMOS" value="1" onclick=updateEntityDropdown("1")> Yes, I'm on contract with ZMOS (Zamil)<br>
				</label>
				<label class="radio">
					<input type="radio" name="Boolean_OnZMOS" value="0" onclick=updateEntityDropdown("0") checked> No<br>
				</label>
			</form>
		<br>
		
	
      <span class="label header">Full name</span><br>
      <input type="text" id="fullname" name="fullname" style="width: 400"><br>
      <br>
	  
      <span class="label header">Job Title</span><br>
      <input type="text" id="jobTitle" name="jobTitle" style="width: 400"><br>
      <br>
	  
      <span class="label header">Department</span><br>
	  <span class="label description">Select from the list OR manually type it if not available from the list provided</span><br>
     <!-- <input type="text" id="department" name="department" style="width: 400"><br>
      <br /> -->

	  <input list="departments" id="department" name="department" style="width: 400"/>
		<datalist id="departments">
			<option value="Administration Dept.">
			<option value="Business Development Dept.">
			<option value="CEO Office">
			<option value="Commercial Dept.">
			<option value="Compliance & IA Dept.">
			<option value="COO Office">
			<option value="Crew Dept.">
			<option value="Crewing Dept.">
			<option value="Diving Dept.">
			<option value="Diving Supervisor Dept. (ZMOS:Diving)">
			<option value="Engineering Dept.">
			<option value="Equipment & Workshop Dept.">
			<option value="Finance & Accounting Dept.">
			<option value="Finance Dept.">
			<option value="Health & Safety (ZMOS:Diving)">
			<option value="Health & Safety Dept.">
			<option value="Health & Safety Dept. (ZMOS:Diving)">
			<option value="HR & Admin Dept.">
			<option value="HR Dept.">
			<option value="Import & Export Dept.">
			<option value="IT Dept.">
			<option value="Legal & Corporate Affairs Dept.">
			<option value="Logistics Dept.">
			<option value="Management Dept.">
			<option value="Marine Fleet Dept.">
			<option value="Office Dept.">
			<option value="Offshore Construction Dept.">
			<option value="Offshore Construction Dept. (ZMOS:Diving)">
			<option value="Operations Dept.">
			<option value="Operations Dept. (ZMOS:Diving)">
			<option value="Operations Director Office">
			<option value="Operations Director Office (ZMOS:Diving)">
			<option value="Procurement  Dept.">
			<option value="Procurement / Logistics Dept">
			<option value="Procurement / Logistics Dept.">
			<option value="Procurement Dept.">
			<option value="Projects Dept.">
			<option value="Projects Dept. (ZMOS:Diving)">
			<option value="Public Relation Dept.">
			<option value="Public Relation/HR Dept.">
			<option value="QHSE Dept.">
			<option value="ROV Dept.">
			<option value="Survey and Inspection Dept.">
			<option value="Survey Dept.">
			<option value="Tier 1 - Executive Management Dept.">
			<option value="Workshop Dept.">
			<option value="Workshop Dept. (ZMOS:Diving)">
			<option value="ZMOS Diving">

		</datalist>
	  <br>
	  <br>
	  
	  <span class="label header">Mobile Number(s) [Optional]</span><br>
      <span class="label description">If you have multiple numbers, use semicolon ';' as separator e.g. <i>UAE: +971-12-3456789 ; Thailand: +6681-987-6543</span></i>
	  <br>
      <input type="text" id="mobileNumbers" name="mobileNumbers" style="width: 400"><br>
      <br>
	  
	  <span class="label header">Telephone Number(s)</span><br>
      <span class="label description">If you have multiple numbers, use semicolon ';' as separator e.g. <i>UAE: +971-12-3456789 ; Thailand: +6681-987-6543</span></i>
	  <br>
      <input type="text" id="phoneNumbers" name="phoneNumbers" style="width: 400"><br>
      <br />
      
	  <span class="label header">Email Address</span><br>
      <input type="text" id="emailAddress" name="emailAddress" style="width: 400"><br>
      <br />
      
    </form>
 
	
	
	<span class="label header">Entity/Brand</span><br>
	 <span class="label description">Most of us are under 'Mermaid Subsea Services', except those in the Head Office or on ZMOS contract</span></i><br>
	<select id="entity" name="entity" style="width: 400">
	  <option value="MSS">Mermaid Subsea Services</option>
	  <option value="MML">Mermaid Maritime Plc.</option>
	</select>
		
	  <br>
	  <br>
	  <br>
 
    <button onClick="javascript:generateSignature();" style="width: 400px; height: 35px"><strong>Generate E-Signature</strong></button>
	<!-- <button onClick="javascript:copyToClipboard('output_iframe');" style="width: 263px; height: 35px">Copy to Clipboard</button> -->
	
    <br>
	<br>
    
    <iframe id="output_iframe" src="about:blank" width=810 height=200></iframe>
 
	<br />
 
    </body>
 
<script language="javascript">
function generateSignature(){
   
    var fullname = document.getElementById("fullname").value
	fullname = "<span><strong>" + fullname + "</strong></span>"
	
	var jobTitle = document.getElementById("jobTitle").value
	var department = document.getElementById("department").value
	
	var mobileNumbers = document.getElementById("mobileNumbers").value
	if(mobileNumbers!=""){
		mobileNumbers = "<span><strong>M </strong>" + mobileNumbers + "</span> | "
	}
	
	var phoneNumbers = document.getElementById("phoneNumbers").value
	
	if(phoneNumbers!=""){
		phoneNumbers = "<span><strong>T </strong>" + phoneNumbers + "</span> | "
	}
	
	var emailAddress = document.getElementById("emailAddress").value
	if(emailAddress!=""){
		emailAddress = "<strong>E </strong>" + '<span> <a href="mailto:' + emailAddress +  '" style="color:blue; text-decoration:underline;">' + emailAddress + "</a></span>"
	}
	
	var string_line_1 = fullname + " | " + jobTitle + " | " + department
	var string_line_2 = mobileNumbers + phoneNumbers + emailAddress
 
 
    //step 1: get the DOM object of the iframe.
    var iframe = document.getElementById('output_iframe');
	var logo_area_width = 79
	var ZMOS_logo_string = ""
	var string_line_3 = ""
	
	var eEntity = document.getElementById("entity");
	var string_line_3_brand = '<span>' + eEntity.options[eEntity.selectedIndex].text +'</span> | ';	
	var string_line_3_website = '<span><a href="https://www.mermaid-group.com">mermaid-group.com</a></span>'
	
	var OnZMOS_cb = document.querySelector('input[name="Boolean_OnZMOS"]:checked')
	
	if (OnZMOS_cb == null){
		alert("Please specify whether you are on contract with ZMOS (Zamil Mermaid Offshore)");
		return;
	} else if (OnZMOS_cb.value == 1){
		ZMOS_logo_string = '<img height="55" src="img/ZMOS_Logo.png" width="111" /></td>';
		logo_area_width = 220;
		string_line_3_website = '<span><a href="http://zamilmermaid.com/">zamilmermaid.com</a></span>'
		}
	
	string_line_3 = string_line_3_brand + string_line_3_website
 
    var html_string = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><title>ESignature</title><style type="text/css">table.MsoNormalTable.nowrapping {white-space: nowrap;}</style></head><body><table border="0" cellspacing="1" style="width: 820px; height: 80px; font-size:10pt; font-family:Calibri,sans-serif;"><tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes; mso-yfti-lastrow: yes"><td style="width: ' + logo_area_width +'px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"><img style="border-width: 0px; font-size:10pt; font-family:Calibri,sans-serif;" height="55" src="img/logo.png" width="77" class="logo"/>' + ZMOS_logo_string + '</a></td><td style="width: 10px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"></td><td style="width: 720px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"><p class="MsoNormal" style="margin:0px"> <span>' + string_line_1 + '</span> <br /> <span>' + string_line_2 + '</span> <br /> ' + string_line_3 + ' </p></td><td style="width: 10px; border-top: solid #E5E5E5 1.0pt; padding: 0in 0in 0in 0in; border-left-style: none; border-left-color: inherit; border-left-width: medium; border-right-style: none; border-right-color: inherit; border-right-width: medium; height: 57px; border-bottom-style: none; border-bottom-color: inherit; border-bottom-width: medium;" valign="top"></td></tr></table><p style="margin-top:8px"><span style="font-family:Calibri,sans-serif; color: #808080; font-size:6pt "><strong>Disclaimers: </strong>This electronic transmission, and any attachments hereto, is intended only for the use of each individual recipient named above and may contain information belonging to the sender that is confidential, proprietary, is subject to copyright, constitutes a trade secret or is legally privileged. If you are not an intended recipient, you are hereby notified that any disclosure, copying, distribution or the taking of any action in reliance on the contents of this information is strictly prohibited. If you have received this transmission in error, please immediately (i) notify the sender, and (ii) permanently delete and/or destroy the original and all copies of this electronic transmission and all attachments hereto.</p></body></html>';
 
    /* if jQuery is available, you may use the get(0) function to obtain the DOM object like this:
    var iframe = $('iframe#target_iframe_id').get(0);
    */
 
    //step 2: obtain the document associated with the iframe tag
    //most of the browser supports .document. Some supports (such as the NetScape series) .contentDocumet, while some (e.g. IE5/6) supports .contentWindow.document
    //we try to read whatever that exists.
    var iframedoc = iframe.document;
        if (iframe.contentDocument)
            iframedoc = iframe.contentDocument;
        else if (iframe.contentWindow)
            iframedoc = iframe.contentWindow.document;

    
     if (iframedoc){
         // Put the content in the iframe
         iframedoc.open();
         iframedoc.writeln(html_string);
         iframedoc.close();
		
     } else {
        //just in case of browsers that don't support the above 3 properties.
        //fortunately we don't come across such case so far.
        alert('Operation not supported by browser');
     }

	 //copyToClipboard('output_iframe');
	 //copyToClip(html_string);
}

function updateEntityDropdown(input){
	//alert(input)
	if (input=="1")
		{
			document.getElementById("entity")[0].selected=true;
			document.getElementById("entity")[0].innerHTML = "Mermaid Subsea Services; Zamil Mermaid Offshore Company";
			document.getElementById("entity").disabled=true;
		} else
		{
			document.getElementById("entity").disabled=false;
			document.getElementById("entity")[0].innerHTML = "Mermaid Subsea Services";
		}
	
}

function copyToClipboard(elementId) {

	var iframe = document.getElementById(elementId);
	var iframe_contents = iframe.contentDocument.body.innerHTML;
	copyToClip(iframe_contents);
	// alert(iframe_contents);

}

function copyToClip(str) {
  
  function listener(e) {
    e.clipboardData.setData("text/html", str);
    e.clipboardData.setData("text/plain", str);
    e.preventDefault();
  }
  document.addEventListener("copy", listener);
  document.execCommand("copy");
  document.removeEventListener("copy", listener);
   
   
};
 

 
</script>
</html>